# ============================================
# Spring Boot 认证服务配置
# ============================================
# Spring Boot 后端的基础 URL（用于 JWT Token 验证）
SPRING_BOOT_URL=http://localhost:3000

# ============================================
# 意图分类器配置
# ============================================
# 是否启用意图分类器（默认：true）
ENABLE_INTENT_CLASSIFIER=true
# 意图分类使用的LLM ID（默认：qwen3-32b）
INTENT_CLASSIFIER_LLM_ID=qwen3-32b
# 意图分类超时时间（秒，默认：5）
INTENT_CLASSIFIER_TIMEOUT=5

# ============================================
# 子问题分解配置
# ============================================
# 是否启用子问题分解功能（默认：false）
ENABLE_SUBQUESTION_DECOMPOSITION=true

# 子问题分解引擎选择：custom（自定义）或 llamaindex（LlamaIndex原生）
# custom: 自己判断是否分解，支持意图路由，完全可控
# llamaindex: LlamaIndex自动分解，开箱即用，但无法控制
SUBQUESTION_ENGINE_TYPE=custom

# 是否使用LLM判断是否需要分解（仅对custom引擎有效）
# true: 智能判断模式 - LLM判断是否需要分解（默认）
# false: 强制分解模式 - 跳过判断，所有问题都分解
SUBQUESTION_USE_LLM_JUDGE=true

# 分解参数
SUBQUESTION_MAX_DEPTH=3                      # 最大子问题数量（默认：3）
SUBQUESTION_MIN_SCORE=0.3                    # 子问题检索最低分数阈值（默认：0.3）
SUBQUESTION_COMPLEXITY_THRESHOLD=20          # 触发分解的最小查询长度（默认：50字符）
SUBQUESTION_DECOMP_LLM_ID=qwen3-32b         # 用于分解的LLM（默认：qwen3-32b）
SUBQUESTION_DECOMP_TIMEOUT=10                # 分解超时时间（秒，默认：10）
SUBQUESTION_SYNTHESIS_TIMEOUT=30             # 答案合成超时时间（秒，默认：30）

# 实体检测
SUBQUESTION_ENABLE_ENTITY_CHECK=false         # 启用命名实体检测（默认：true）
SUBQUESTION_MIN_ENTITIES=2                   # 触发分解的最小实体数（默认：2）

# 对话历史压缩（多轮场景）
SUBQUESTION_HISTORY_COMPRESS_TURNS=5         # 压缩最近N轮对话（默认：5）
SUBQUESTION_HISTORY_MAX_TOKENS=500           # 历史摘要最大token数（默认：500）

# 健康度指标
SUBQUESTION_MAX_EMPTY_RESULTS=2              # 允许的最大空结果子问题数（默认：2）
SUBQUESTION_FALLBACK_ON_ERROR=true           # 错误时回退到标准检索（默认：true）

# ============================================
# RRF 融合权重配置
# ============================================
RRF_K=10.0                                   # RRF 平滑参数（默认：10.0）
RRF_VECTOR_WEIGHT=0.7                        # 向量检索权重（默认：0.7）
RRF_BM25_WEIGHT=0.3                          # BM25 检索权重（默认：0.3）

# ============================================
# RAG 核心参数
# ============================================
RETRIEVAL_TOP_K=50                           # 向量检索数量（默认：30）
RETRIEVAL_TOP_K_BM25=10                      # BM25检索数量（默认：30）
RERANK_TOP_N=20                              # 重排序后返回数量（默认：20）
RERANKER_INPUT_TOP_N=30                      # 送入重排序的数量（默认：30）
RETRIEVAL_SCORE_THRESHOLD=0.2                # 检索分数阈值（默认：0.2）
RERANK_SCORE_THRESHOLD=0.2                   # 重排序分数阈值（默认：0.2）

# ============================================
# 免签知识库配置
# ============================================
VISA_FREE_RETRIEVAL_COUNT=5                  # 免签库检索数量（默认：5）
GENERAL_RETRIEVAL_COUNT=5                    # 通用库检索数量（默认：5）

# ============================================
# LLM 行为参数
# ============================================
LLM_REQUEST_TIMEOUT=1800.0                   # LLM请求超时（秒，默认：1800）
LLM_CONTEXT_WINDOW=32768                     # LLM上下文窗口（默认：32768）
LLM_MAX_TOKENS=8192                          # LLM最大生成tokens（默认：8192）
LLM_MAX_RETRIES=2                            # LLM最大重试次数（默认：2）
TEMPERATURE_DISASSEMBLY=0.0                  # 分解任务温度（默认：0.0）
TEMPERATURE_ANALYSIS_ON=0.5                  # 分析任务温度（默认：0.5）

# ============================================
# 设备配置
# ============================================
# 设备类型：npu, cpu（默认：自动检测）
# DEVICE=cpu

# ============================================
# Qdrant 配置
# ============================================
QDRANT_HOST=localhost                        # Qdrant主机（默认：localhost）
QDRANT_PORT=6333                             # Qdrant端口（默认：6333）
QDRANT_COLLECTION=travel_kb                  # 通用库集合名（默认：travel_kb）

# ============================================
# 规则知识库配置
# ============================================
# ENABLE_RULES_FEATURE=true                    # 是否启用规则库（默认：true）
# RULES_FIXED_INJECT_COUNT=3                   # 每次固定注入规则数（默认：3）

# ============================================
# 其他功能开关
# ============================================
# 是否启用NPU加速（默认：false）
# NPU_AVAILABLE=false

